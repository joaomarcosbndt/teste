<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Almoxarifado Instalações</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="imagens0/favicon.ico" type="image/x-icon">
</head>
<body>
  <h1>Estoque de Materiais Beach Class</h1>

  <input type="text" id="busca" placeholder="Buscar material...">

  <p id="loading">Carregando tabela, por favor aguarde...</p>

  <table id="tabela"></table>

  <script>
    const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRX30c_6AmyZbmTfPHwaAr1aNgzZ_qWk9EvoDLyOCcuRgUhMenT91yLPXMzNOYeJExosBal6yGhM0V0/pub?output=csv';

    fetch(url)
      .then(response => response.text())
      .then(text => {
        const linhas = text.trim().split('\n').map(l => l.split(','));
        const tabela = document.getElementById('tabela');
        const cabecalhos = linhas[0]; // primeira linha é o cabeçalho

        // cria cabeçalho
        const trCabecalho = document.createElement('tr');
        cabecalhos.forEach(titulo => {
          const th = document.createElement('th');
          th.textContent = titulo;
          trCabecalho.appendChild(th);
        });
        tabela.appendChild(trCabecalho);

        // cria linhas de dados
        for (let i = 1; i < linhas.length; i++) {
          const tr = document.createElement('tr');
          linhas[i].forEach((cel, j) => {
            const td = document.createElement('td');
            td.setAttribute('data-label', cabecalhos[j]);
            
            // adiciona <span> para o CSS responsivo alinhar o texto
            const span = document.createElement('span');
            span.textContent = cel;
            td.appendChild(span);
            tr.appendChild(td);
          });
          tabela.appendChild(tr);
        }

        // Esconde a mensagem de carregamento
        document.getElementById('loading').style.display = 'none';

        // Campo de busca
        const input = document.getElementById('busca');
        input.addEventListener('keyup', () => {
          const termo = input.value.toLowerCase();
          const linhasTabela = tabela.getElementsByTagName('tr');
          
          for (let i = 1; i < linhasTabela.length; i++) { // ignora cabeçalho
            const celulas = linhasTabela[i].getElementsByTagName('td');
            let corresponde = false;
            for (let c = 0; c < celulas.length; c++) {
              if (celulas[c].textContent.toLowerCase().includes(termo)) {
                corresponde = true;
                break;
              }
            }
            linhasTabela[i].style.display = corresponde ? '' : 'none';
          }
        });
      })
      .catch(err => {
        console.error('Erro ao carregar CSV:', err);
        document.body.insertAdjacentHTML('beforeend', '<p>Falha ao carregar os dados.</p>');
      });
  </script>
</body>
</html>
